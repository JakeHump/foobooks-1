path='/var/www/html/foobooks'
sshLogin=root@138.197.115.70


#
#
#
function dump {
    echo -e "===> \033[1m"$1"\033[0m"
}


#
#
#
function doDeploy {

    status="cd /var/www/html/foobooks; git status"

    if [[ $status == *"nothing to commit, working directory clean"* ]]; then
        dump "Working directory clean on production, proceeding with deployment."
        git pull
        composer install

    else
        dump "There are changes on your production server; aborting deployment;"
        dump "Commit/checkout those changes and then try again."
    fi
}



# Running this script on production, invoke doDeploy
if [[ $(pwd) == *"/var/www/html"* ]]; then
    doDeploy
# Running this script on local, invoke doDeploy via SSH
else
    ssh root@138.197.115.70 "/var/www/html/foobooks/deploy";
fi
